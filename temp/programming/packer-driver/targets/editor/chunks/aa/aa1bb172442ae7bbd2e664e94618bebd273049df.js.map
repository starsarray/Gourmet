{"version":3,"sources":["file:///D:/ProgramData/cocos/workplace/Gourmet/assets/script/Recipes/IngredientSearch.ts"],"names":["_decorator","Button","Color","Component","instantiate","Label","Node","Prefab","RecipesGenerate","ccclass","property","IngredientSearch","selectedIngredients","selectedCookingMethod","onLoad","generateIngredientButtons","generateCookingMethodButtons","ingredients","forEach","ingredient","button","ingredientButtonPrefab","label","getComponentInChildren","string","on","EventType","CLICK","onIngredientSelected","ingredientsContainer","addChild","cookingMethods","method","cookingMethodButtonPrefab","onCookingMethodSelected","cookingMethodsContainer","indexOf","filter","item","getComponent","normalColor","defaultColor","push","selectedColor","updateRecipeList","children","child","results","filterRecipes","updateRecipeDisplay","recipesGenerate","recipeData","recipes","recipe","every","includes","cooking_methods","recipeListContainer","removeAllChildren","listItem","recipeListItemPrefab","nameLabel","getChildByName","ingredientsLabel","cookingMethodsLabel","name","join"],"mappings":"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","sourcesContent":["import { _decorator, Button, Color, Component, instantiate, Label, Node, Prefab } from 'cc';\r\nimport { RecipesGenerate } from './RecipesGenerate';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('IngredientSearch')\r\nexport class IngredientSearch extends Component {\r\n    @property(Node)\r\n    ingredientsContainer: Node = null;  // 多选食材区域\r\n\r\n    @property(Node)\r\n    cookingMethodsContainer: Node = null;  // 单选烹饪方式区域\r\n\r\n    @property(Node)\r\n    recipeListContainer: Node = null;  // 筛选结果区域\r\n\r\n    @property(Prefab)\r\n    ingredientButtonPrefab: Prefab = null;  // 预制件，用于生成食材按钮\r\n\r\n    @property(Prefab)\r\n    cookingMethodButtonPrefab: Prefab = null;  // 预制件，用于生成烹饪方式按钮\r\n\r\n    @property(Prefab)\r\n    recipeListItemPrefab: Prefab = null; // 筛选结果列表项预制体\r\n\r\n    @property(RecipesGenerate)\r\n    recipesGenerate: RecipesGenerate = null;  // 绑定 RecipesGenerate 脚本\r\n\r\n    @property(Color)\r\n    selectedColor: Color = new Color(53, 192, 0);  // 选中时背景颜色 35C000\r\n\r\n    @property(Color)\r\n    defaultColor: Color = new Color(225, 255, 160);  // 默认背景颜色 E1FFA0\r\n\r\n    private selectedIngredients: string[] = [];  // 已选择的食材列表\r\n    private selectedCookingMethod: string = '';  // 已选择的烹饪方式\r\n\r\n    onLoad() {\r\n        // 初始化食材按钮和烹饪方式按钮\r\n        this.generateIngredientButtons();\r\n        this.generateCookingMethodButtons();\r\n    }\r\n\r\n    generateIngredientButtons() {\r\n        const ingredients = [\"鸡蛋\", \"盐\", \"番茄\", \"葱\", \"香油\", \"酱油\"];  // 示例食材\r\n\r\n        ingredients.forEach(ingredient => {\r\n            const button = instantiate(this.ingredientButtonPrefab);\r\n            const label = button.getComponentInChildren(Label);\r\n            if (label) {\r\n                label.string = ingredient;\r\n            }\r\n            button.on(Button.EventType.CLICK, () => this.onIngredientSelected(button, ingredient), this);\r\n            this.ingredientsContainer.addChild(button);\r\n        });\r\n    }\r\n\r\n    generateCookingMethodButtons() {\r\n        const cookingMethods = [\"锅\", \"电饭煲\"];  // 示例烹饪方式\r\n\r\n        cookingMethods.forEach(method => {\r\n            const button = instantiate(this.cookingMethodButtonPrefab);\r\n            const label = button.getComponentInChildren(Label);\r\n            if (label) {\r\n                label.string = method;\r\n            }\r\n            button.on(Button.EventType.CLICK, () => this.onCookingMethodSelected(button, method), this);\r\n            this.cookingMethodsContainer.addChild(button);\r\n        });\r\n    }\r\n\r\n    onIngredientSelected(button: Node, ingredient: string) {\r\n        if (this.selectedIngredients.indexOf(ingredient)) {\r\n            // 如果已选中，则取消选择\r\n            this.selectedIngredients = this.selectedIngredients.filter(item => item !== ingredient);\r\n            button.getComponent(Button).normalColor = this.defaultColor;\r\n        } else {\r\n            // 如果未选中，则选择\r\n            this.selectedIngredients.push(ingredient);\r\n            button.getComponent(Button).normalColor = this.selectedColor;\r\n        }\r\n        this.updateRecipeList();\r\n    }\r\n\r\n    onCookingMethodSelected(button: Node, method: string) {\r\n        // 清除其他按钮的选中状态\r\n        this.cookingMethodsContainer.children.forEach(child => {\r\n            child.getComponent(Button).normalColor = this.defaultColor;\r\n        });\r\n\r\n        // 选择当前按钮\r\n        this.selectedCookingMethod = method;\r\n        button.getComponent(Button).normalColor = this.selectedColor;\r\n\r\n        this.updateRecipeList();\r\n    }\r\n\r\n    updateRecipeList() {\r\n        const results = this.filterRecipes();\r\n        this.updateRecipeDisplay(results);\r\n    }\r\n\r\n    filterRecipes(): Array<any> {\r\n        // 结合已选食材和烹饪方式过滤食谱\r\n        return this.recipesGenerate.recipeData.recipes.filter(recipe => \r\n            this.selectedIngredients.every(ingredient => recipe.ingredients.includes(ingredient)) &&\r\n            (!this.selectedCookingMethod || recipe.cooking_methods.includes(this.selectedCookingMethod))\r\n        );\r\n    }\r\n\r\n    updateRecipeDisplay(recipes: Array<any>) {\r\n        // 清空当前显示的结果\r\n        this.recipeListContainer.removeAllChildren();\r\n\r\n        recipes.forEach(recipe => {\r\n            const listItem = instantiate(this.recipeListItemPrefab);\r\n            const nameLabel = listItem.getChildByName(\"NameLabel\").getComponent(Label);\r\n            const ingredientsLabel = listItem.getChildByName(\"IngredientsLabel\").getComponent(Label);\r\n            const cookingMethodsLabel = listItem.getChildByName(\"CookingMethodsLabel\").getComponent(Label);\r\n\r\n            if (nameLabel) nameLabel.string = recipe.name;\r\n            if (ingredientsLabel) ingredientsLabel.string = `食材：${recipe.ingredients.join(\", \")}`;\r\n            if (cookingMethodsLabel) cookingMethodsLabel.string = `烹饪方式：${recipe.cooking_methods.join(\", \")}`;\r\n\r\n            this.recipeListContainer.addChild(listItem);\r\n        });\r\n    }\r\n}\r\n\r\n\r\n"]}